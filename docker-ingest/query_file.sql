with list_tags as (
	select
		etm.entity_id as loan_id,
		listagg(lpad(t.id::varchar,5,'0'), '|') as user_tag_list
	from entity_tag_mapper etm
	inner join tag t on etm.tag_id = t.id
	inner join vocabulary v on t.vocabulary_id = v.id
		and v.name = 'user_defined_loan_tags'
	where etm.entity_name = 'business'
	group by etm.entity_id
),
list_filters as (
	select 
		ltfm.loan_theme_instance_id,
		listagg(lpad(ltfm.id::varchar,5,'0'), '|') as theme_filter_id_list
	from loan_theme_filter_mapper ltfm
	inner join loan_theme_filter ltf on ltf.id = ltfm.loan_theme_filter_id
	where ltf.is_active = true and ltf.is_visible = true
	group by ltfm.loan_theme_instance_id
)
select
	l.id as loan_id,
	count(case when b.distribution_model = 'direct' then 1 end) as is_direct,
	count(case when b.distribution_model = 'field_partner' then 1 end) as is_field_partner,
	count(case when a.id = 9 then 1 end) as activity_9,
	count(case when a.id = 11 then 1 end) as activity_11,
	count(case when a.id = 12 then 1 end) as activity_12,
	count(case when a.id = 13 then 1 end) as activity_13,
	count(case when a.id = 14 then 1 end) as activity_14,
	count(case when a.id = 15 then 1 end) as activity_15,
	count(case when a.id = 17 then 1 end) as activity_17,
	count(case when a.id = 18 then 1 end) as activity_18,
	count(case when a.id = 19 then 1 end) as activity_19,
	count(case when a.id = 21 then 1 end) as activity_21,
	count(case when a.id = 23 then 1 end) as activity_23,
	count(case when a.id = 24 then 1 end) as activity_24,
	count(case when a.id = 25 then 1 end) as activity_25,
	count(case when a.id = 26 then 1 end) as activity_26,
	count(case when a.id = 27 then 1 end) as activity_27,
	count(case when a.id = 28 then 1 end) as activity_28,
	count(case when a.id = 29 then 1 end) as activity_29,
	count(case when a.id = 31 then 1 end) as activity_31,
	count(case when a.id = 32 then 1 end) as activity_32,
	count(case when a.id = 33 then 1 end) as activity_33,
	count(case when a.id = 34 then 1 end) as activity_34,
	count(case when a.id = 35 then 1 end) as activity_35,
	count(case when a.id = 37 then 1 end) as activity_37,
	count(case when a.id = 39 then 1 end) as activity_39,
	count(case when a.id = 40 then 1 end) as activity_40,
	count(case when a.id = 41 then 1 end) as activity_41,
	count(case when a.id = 43 then 1 end) as activity_43,
	count(case when a.id = 45 then 1 end) as activity_45,
	count(case when a.id = 46 then 1 end) as activity_46,
	count(case when a.id = 47 then 1 end) as activity_47,
	count(case when a.id = 49 then 1 end) as activity_49,
	count(case when a.id = 51 then 1 end) as activity_51,
	count(case when a.id = 52 then 1 end) as activity_52,
	count(case when a.id = 54 then 1 end) as activity_54,
	count(case when a.id = 56 then 1 end) as activity_56,
	count(case when a.id = 57 then 1 end) as activity_57,
	count(case when a.id = 59 then 1 end) as activity_59,
	count(case when a.id = 60 then 1 end) as activity_60,
	count(case when a.id = 61 then 1 end) as activity_61,
	count(case when a.id = 62 then 1 end) as activity_62,
	count(case when a.id = 63 then 1 end) as activity_63,
	count(case when a.id = 65 then 1 end) as activity_65,
	count(case when a.id = 66 then 1 end) as activity_66,
	count(case when a.id = 67 then 1 end) as activity_67,
	count(case when a.id = 68 then 1 end) as activity_68,
	count(case when a.id = 70 then 1 end) as activity_70,
	count(case when a.id = 72 then 1 end) as activity_72,
	count(case when a.id = 73 then 1 end) as activity_73,
	count(case when a.id = 75 then 1 end) as activity_75,
	count(case when a.id = 76 then 1 end) as activity_76,
	count(case when a.id = 78 then 1 end) as activity_78,
	count(case when a.id = 79 then 1 end) as activity_79,
	count(case when a.id = 80 then 1 end) as activity_80,
	count(case when a.id = 81 then 1 end) as activity_81,
	count(case when a.id = 84 then 1 end) as activity_84,
	count(case when a.id = 85 then 1 end) as activity_85,
	count(case when a.id = 86 then 1 end) as activity_86,
	count(case when a.id = 87 then 1 end) as activity_87,
	count(case when a.id = 88 then 1 end) as activity_88,
	count(case when a.id = 89 then 1 end) as activity_89,
	count(case when a.id = 91 then 1 end) as activity_91,
	count(case when a.id = 92 then 1 end) as activity_92,
	count(case when a.id = 94 then 1 end) as activity_94,
	count(case when a.id = 95 then 1 end) as activity_95,
	count(case when a.id = 96 then 1 end) as activity_96,
	count(case when a.id = 97 then 1 end) as activity_97,
	count(case when a.id = 98 then 1 end) as activity_98,
	count(case when a.id = 99 then 1 end) as activity_99,
	count(case when a.id = 100 then 1 end) as activity_100,
	count(case when a.id = 101 then 1 end) as activity_101,
	count(case when a.id = 102 then 1 end) as activity_102,
	count(case when a.id = 103 then 1 end) as activity_103,
	count(case when a.id = 104 then 1 end) as activity_104,
	count(case when a.id = 105 then 1 end) as activity_105,
	count(case when a.id = 107 then 1 end) as activity_107,
	count(case when a.id = 108 then 1 end) as activity_108,
	count(case when a.id = 109 then 1 end) as activity_109,
	count(case when a.id = 110 then 1 end) as activity_110,
	count(case when a.id = 111 then 1 end) as activity_111,
	count(case when a.id = 112 then 1 end) as activity_112,
	count(case when a.id = 114 then 1 end) as activity_114,
	count(case when a.id = 115 then 1 end) as activity_115,
	count(case when a.id = 116 then 1 end) as activity_116,
	count(case when a.id = 117 then 1 end) as activity_117,
	count(case when a.id = 119 then 1 end) as activity_119,
	count(case when a.id = 120 then 1 end) as activity_120,
	count(case when a.id = 121 then 1 end) as activity_121,
	count(case when a.id = 123 then 1 end) as activity_123,
	count(case when a.id = 124 then 1 end) as activity_124,
	count(case when a.id = 125 then 1 end) as activity_125,
	count(case when a.id = 127 then 1 end) as activity_127,
	count(case when a.id = 128 then 1 end) as activity_128,
	count(case when a.id = 129 then 1 end) as activity_129,
	count(case when a.id = 130 then 1 end) as activity_130,
	count(case when a.id = 131 then 1 end) as activity_131,
	count(case when a.id = 132 then 1 end) as activity_132,
	count(case when a.id = 133 then 1 end) as activity_133,
	count(case when a.id = 134 then 1 end) as activity_134,
	count(case when a.id = 135 then 1 end) as activity_135,
	count(case when a.id = 137 then 1 end) as activity_137,
	count(case when a.id = 138 then 1 end) as activity_138,
	count(case when a.id = 140 then 1 end) as activity_140,
	count(case when a.id = 141 then 1 end) as activity_141,
	count(case when a.id = 142 then 1 end) as activity_142,
	count(case when a.id = 143 then 1 end) as activity_143,
	count(case when a.id = 144 then 1 end) as activity_144,
	count(case when a.id = 145 then 1 end) as activity_145,
	count(case when a.id = 146 then 1 end) as activity_146,
	count(case when a.id = 147 then 1 end) as activity_147,
	count(case when a.id = 149 then 1 end) as activity_149,
	count(case when a.id = 151 then 1 end) as activity_151,
	count(case when a.id = 156 then 1 end) as activity_156,
	count(case when a.id = 157 then 1 end) as activity_157,
	count(case when a.id = 158 then 1 end) as activity_158,
	count(case when a.id = 159 then 1 end) as activity_159,
	count(case when a.id = 161 then 1 end) as activity_161,
	count(case when a.id = 162 then 1 end) as activity_162,
	count(case when a.id = 163 then 1 end) as activity_163,
	count(case when a.id = 164 then 1 end) as activity_164,
	count(case when a.id = 165 then 1 end) as activity_165,
	count(case when a.id = 167 then 1 end) as activity_167,
	count(case when a.id = 169 then 1 end) as activity_169,
	count(case when a.id = 170 then 1 end) as activity_170,
	count(case when a.id = 171 then 1 end) as activity_171,
	count(case when a.id = 172 then 1 end) as activity_172,
	count(case when a.id = 174 then 1 end) as activity_174,
	count(case when a.id = 175 then 1 end) as activity_175,
	count(case when a.id = 176 then 1 end) as activity_176,
	count(case when a.id = 177 then 1 end) as activity_177,
	count(case when a.id = 180 then 1 end) as activity_180,
	count(case when a.id = 181 then 1 end) as activity_181,
	count(case when a.id = 183 then 1 end) as activity_183,
	count(case when a.id = 184 then 1 end) as activity_184,
	count(case when a.id = 185 then 1 end) as activity_185,
	count(case when a.id = 186 then 1 end) as activity_186,
	count(case when a.id = 192 then 1 end) as activity_192,
	count(case when a.id = 193 then 1 end) as activity_193,
	count(case when a.id = 194 then 1 end) as activity_194,
	count(case when a.id = 195 then 1 end) as activity_195,
	count(case when a.id = 196 then 1 end) as activity_196,
	count(case when a.id = 197 then 1 end) as activity_197,
	count(case when a.id = 199 then 1 end) as activity_199,
	count(case when a.id = 200 then 1 end) as activity_200,
	count(case when a.id = 201 then 1 end) as activity_201,
	count(case when a.id = 202 then 1 end) as activity_202,
	count(case when a.id = 203 then 1 end) as activity_203,
	count(case when a.id = 204 then 1 end) as activity_204,
	count(case when a.id = 206 then 1 end) as activity_206,
	count(case when a.id = 207 then 1 end) as activity_207,
	count(case when a.id = 208 then 1 end) as activity_208,
	count(case when a.id = 209 then 1 end) as activity_209,
	count(case when a.id = 210 then 1 end) as activity_210,
	count(case when a.id = 216 then 1 end) as activity_216,
	count(case when a.id = 217 then 1 end) as activity_217,
	count(case when a.id = 218 then 1 end) as activity_218,
	count(case when a.id = 219 then 1 end) as activity_219,
	count(case when a.id = 220 then 1 end) as activity_220,
	count(case when a.id = 221 then 1 end) as activity_221,
	count(case when a.id = 222 then 1 end) as activity_222,
	count(case when a.id = 223 then 1 end) as activity_223,
	count(case when a.id = 224 then 1 end) as activity_224,
	count(case when a.id = 225 then 1 end) as activity_225,
	count(case when a.id = 226 then 1 end) as activity_226,
	count(case when s.id = 1 then 1 end) as sector_1,
	count(case when s.id = 3 then 1 end) as sector_3,
	count(case when s.id = 4 then 1 end) as sector_4,
	count(case when s.id = 5 then 1 end) as sector_5,
	count(case when s.id = 6 then 1 end) as sector_6,
	count(case when s.id = 7 then 1 end) as sector_7,
	count(case when s.id = 8 then 1 end) as sector_8,
	count(case when s.id = 9 then 1 end) as sector_9,
	count(case when s.id = 10 then 1 end) as sector_10,
	count(case when s.id = 12 then 1 end) as sector_12,
	count(case when s.id = 13 then 1 end) as sector_13,
	count(case when s.id = 14 then 1 end) as sector_14,
	count(case when s.id = 15 then 1 end) as sector_15,
	count(case when s.id = 16 then 1 end) as sector_16,
	count(case when s.id = 17 then 1 end) as sector_17,
	count(case when ltfa.theme_filter_id_list like '%00001%' then 1 end) as theme_filter_1,
	count(case when ltfa.theme_filter_id_list like '%00002%' then 1 end) as theme_filter_2,
	count(case when ltfa.theme_filter_id_list like '%00003%' then 1 end) as theme_filter_3,
	count(case when ltfa.theme_filter_id_list like '%00004%' then 1 end) as theme_filter_4,
	count(case when ltfa.theme_filter_id_list like '%00005%' then 1 end) as theme_filter_5,
	count(case when ltfa.theme_filter_id_list like '%00006%' then 1 end) as theme_filter_6,
	count(case when ltfa.theme_filter_id_list like '%00007%' then 1 end) as theme_filter_7,
	count(case when ltfa.theme_filter_id_list like '%00008%' then 1 end) as theme_filter_8,
	count(case when ltfa.theme_filter_id_list like '%00009%' then 1 end) as theme_filter_9,
	count(case when ltfa.theme_filter_id_list like '%00010%' then 1 end) as theme_filter_10,
	count(case when ltfa.theme_filter_id_list like '%00011%' then 1 end) as theme_filter_11,
	count(case when ltfa.theme_filter_id_list like '%00012%' then 1 end) as theme_filter_12,
	count(case when ltfa.theme_filter_id_list like '%00013%' then 1 end) as theme_filter_13,
	count(case when ltfa.theme_filter_id_list like '%00014%' then 1 end) as theme_filter_14,
	count(case when ltfa.theme_filter_id_list like '%00015%' then 1 end) as theme_filter_15,
	count(case when ltfa.theme_filter_id_list like '%00016%' then 1 end) as theme_filter_16,
	count(case when ltfa.theme_filter_id_list like '%00017%' then 1 end) as theme_filter_17,
	count(case when ltfa.theme_filter_id_list like '%00018%' then 1 end) as theme_filter_18,
	count(case when ltfa.theme_filter_id_list like '%00019%' then 1 end) as theme_filter_19,
	count(case when ltfa.theme_filter_id_list like '%00020%' then 1 end) as theme_filter_20,
	count(case when ltfa.theme_filter_id_list like '%00021%' then 1 end) as theme_filter_21,
	count(case when ltfa.theme_filter_id_list like '%00022%' then 1 end) as theme_filter_22,
	count(case when ltfa.theme_filter_id_list like '%00023%' then 1 end) as theme_filter_23,
	count(case when ltfa.theme_filter_id_list like '%00024%' then 1 end) as theme_filter_24,
	count(case when ltfa.theme_filter_id_list like '%00025%' then 1 end) as theme_filter_25,
	count(case when ltfa.theme_filter_id_list like '%00026%' then 1 end) as theme_filter_26,
	count(case when ltfa.theme_filter_id_list like '%00027%' then 1 end) as theme_filter_27,
	count(case when ltfa.theme_filter_id_list like '%00028%' then 1 end) as theme_filter_28,
	count(case when ltfa.theme_filter_id_list like '%00029%' then 1 end) as theme_filter_29,
	count(case when ltfa.theme_filter_id_list like '%00030%' then 1 end) as theme_filter_30,
	count(case when ltfa.theme_filter_id_list like '%00031%' then 1 end) as theme_filter_31,
	count(case when ltfa.theme_filter_id_list like '%00032%' then 1 end) as theme_filter_32,
	count(case when ltfa.theme_filter_id_list like '%00033%' then 1 end) as theme_filter_33,
	count(case when lti.loan_theme_type_id = 1 then 1 end) as theme_type_1,
	count(case when lti.loan_theme_type_id = 2 then 1 end) as theme_type_2,
	count(case when lti.loan_theme_type_id = 3 then 1 end) as theme_type_3,
	count(case when lti.loan_theme_type_id = 4 then 1 end) as theme_type_4,
	count(case when lti.loan_theme_type_id = 5 then 1 end) as theme_type_5,
	count(case when lti.loan_theme_type_id = 6 then 1 end) as theme_type_6,
	count(case when lti.loan_theme_type_id = 7 then 1 end) as theme_type_7,
	count(case when lti.loan_theme_type_id = 8 then 1 end) as theme_type_8,
	count(case when lti.loan_theme_type_id = 9 then 1 end) as theme_type_9,
	count(case when lti.loan_theme_type_id = 10 then 1 end) as theme_type_10,
	count(case when lti.loan_theme_type_id = 11 then 1 end) as theme_type_11,
	count(case when lti.loan_theme_type_id = 12 then 1 end) as theme_type_12,
	count(case when lti.loan_theme_type_id = 13 then 1 end) as theme_type_13,
	count(case when lti.loan_theme_type_id = 14 then 1 end) as theme_type_14,
	count(case when lti.loan_theme_type_id = 15 then 1 end) as theme_type_15,
	count(case when lti.loan_theme_type_id = 16 then 1 end) as theme_type_16,
	count(case when lti.loan_theme_type_id = 17 then 1 end) as theme_type_17,
	count(case when lti.loan_theme_type_id = 18 then 1 end) as theme_type_18,
	count(case when lti.loan_theme_type_id = 19 then 1 end) as theme_type_19,
	count(case when lti.loan_theme_type_id = 20 then 1 end) as theme_type_20,
	count(case when lti.loan_theme_type_id = 21 then 1 end) as theme_type_21,
	count(case when lti.loan_theme_type_id = 22 then 1 end) as theme_type_22,
	count(case when lti.loan_theme_type_id = 23 then 1 end) as theme_type_23,
	count(case when lti.loan_theme_type_id = 24 then 1 end) as theme_type_24,
	count(case when lti.loan_theme_type_id = 25 then 1 end) as theme_type_25,
	count(case when lti.loan_theme_type_id = 26 then 1 end) as theme_type_26,
	count(case when lti.loan_theme_type_id = 27 then 1 end) as theme_type_27,
	count(case when lti.loan_theme_type_id = 28 then 1 end) as theme_type_28,
	count(case when lti.loan_theme_type_id = 29 then 1 end) as theme_type_29,
	count(case when lti.loan_theme_type_id = 30 then 1 end) as theme_type_30,
	count(case when lti.loan_theme_type_id = 31 then 1 end) as theme_type_31,
	count(case when lti.loan_theme_type_id = 32 then 1 end) as theme_type_32,
	count(case when lti.loan_theme_type_id = 33 then 1 end) as theme_type_33,
	count(case when lti.loan_theme_type_id = 34 then 1 end) as theme_type_34,
	count(case when lti.loan_theme_type_id = 35 then 1 end) as theme_type_35,
	count(case when lti.loan_theme_type_id = 36 then 1 end) as theme_type_36,
	count(case when lti.loan_theme_type_id = 37 then 1 end) as theme_type_37,
	count(case when lti.loan_theme_type_id = 38 then 1 end) as theme_type_38,
	count(case when lti.loan_theme_type_id = 39 then 1 end) as theme_type_39,
	count(case when lti.loan_theme_type_id = 40 then 1 end) as theme_type_40,
	count(case when lti.loan_theme_type_id = 41 then 1 end) as theme_type_41,
	count(case when lti.loan_theme_type_id = 42 then 1 end) as theme_type_42,
	count(case when lti.loan_theme_type_id = 43 then 1 end) as theme_type_43,
	count(case when lti.loan_theme_type_id = 44 then 1 end) as theme_type_44,
	count(case when lti.loan_theme_type_id = 45 then 1 end) as theme_type_45,
	count(case when lti.loan_theme_type_id = 46 then 1 end) as theme_type_46,
	count(case when lti.loan_theme_type_id = 47 then 1 end) as theme_type_47,
	count(case when lti.loan_theme_type_id = 48 then 1 end) as theme_type_48,
	count(case when lti.loan_theme_type_id = 49 then 1 end) as theme_type_49,
	count(case when lti.loan_theme_type_id = 50 then 1 end) as theme_type_50,
	count(case when lti.loan_theme_type_id = 51 then 1 end) as theme_type_51,
	count(case when lti.loan_theme_type_id = 52 then 1 end) as theme_type_52,
	count(case when lti.loan_theme_type_id = 53 then 1 end) as theme_type_53,
	count(case when lti.loan_theme_type_id = 54 then 1 end) as theme_type_54,
	count(case when lti.loan_theme_type_id = 55 then 1 end) as theme_type_55,
	count(case when lti.loan_theme_type_id = 56 then 1 end) as theme_type_56,
	count(case when lti.loan_theme_type_id = 57 then 1 end) as theme_type_57,
	count(case when lti.loan_theme_type_id = 58 then 1 end) as theme_type_58,
	count(case when lti.loan_theme_type_id = 59 then 1 end) as theme_type_59,
	count(case when lti.loan_theme_type_id = 60 then 1 end) as theme_type_60,
	count(case when lti.loan_theme_type_id = 61 then 1 end) as theme_type_61,
	count(case when lti.loan_theme_type_id = 62 then 1 end) as theme_type_62,
	count(case when lti.loan_theme_type_id = 63 then 1 end) as theme_type_63,
	count(case when lti.loan_theme_type_id = 64 then 1 end) as theme_type_64,
	count(case when lti.loan_theme_type_id = 65 then 1 end) as theme_type_65,
	count(case when lti.loan_theme_type_id = 66 then 1 end) as theme_type_66,
	count(case when lti.loan_theme_type_id = 67 then 1 end) as theme_type_67,
	count(case when lti.loan_theme_type_id = 68 then 1 end) as theme_type_68,
	count(case when lti.loan_theme_type_id = 69 then 1 end) as theme_type_69,
	count(case when lti.loan_theme_type_id = 70 then 1 end) as theme_type_70,
	count(case when lti.loan_theme_type_id = 71 then 1 end) as theme_type_71,
	count(case when lti.loan_theme_type_id = 72 then 1 end) as theme_type_72,
	count(case when lti.loan_theme_type_id = 73 then 1 end) as theme_type_73,
	count(case when lti.loan_theme_type_id = 74 then 1 end) as theme_type_74,
	count(case when lti.loan_theme_type_id = 75 then 1 end) as theme_type_75,
	count(case when lti.loan_theme_type_id = 76 then 1 end) as theme_type_76,
	count(case when lti.loan_theme_type_id = 77 then 1 end) as theme_type_77,
	count(case when lti.loan_theme_type_id = 78 then 1 end) as theme_type_78,
	count(case when lti.loan_theme_type_id = 79 then 1 end) as theme_type_79,
	count(case when lti.loan_theme_type_id = 80 then 1 end) as theme_type_80,
	count(case when lti.loan_theme_type_id = 81 then 1 end) as theme_type_81,
	count(case when lti.loan_theme_type_id = 82 then 1 end) as theme_type_82,
	count(case when lti.loan_theme_type_id = 83 then 1 end) as theme_type_83,
	count(case when lti.loan_theme_type_id = 84 then 1 end) as theme_type_84,
	count(case when lti.loan_theme_type_id = 85 then 1 end) as theme_type_85,
	count(case when lti.loan_theme_type_id = 86 then 1 end) as theme_type_86,
	count(case when lti.loan_theme_type_id = 87 then 1 end) as theme_type_87,
	count(case when lti.loan_theme_type_id = 88 then 1 end) as theme_type_88,
	count(case when lti.loan_theme_type_id = 89 then 1 end) as theme_type_89,
	count(case when lti.loan_theme_type_id = 90 then 1 end) as theme_type_90,
	count(case when lti.loan_theme_type_id = 91 then 1 end) as theme_type_91,
	count(case when lti.loan_theme_type_id = 92 then 1 end) as theme_type_92,
	count(case when lti.loan_theme_type_id = 93 then 1 end) as theme_type_93,
	count(case when lti.loan_theme_type_id = 94 then 1 end) as theme_type_94,
	count(case when lti.loan_theme_type_id = 95 then 1 end) as theme_type_95,
	count(case when lti.loan_theme_type_id = 96 then 1 end) as theme_type_96,
	count(case when lti.loan_theme_type_id = 97 then 1 end) as theme_type_97,
	count(case when lti.loan_theme_type_id = 98 then 1 end) as theme_type_98,
	count(case when lti.loan_theme_type_id = 99 then 1 end) as theme_type_99,
	count(case when lti.loan_theme_type_id = 100 then 1 end) as theme_type_100,
	count(case when lti.loan_theme_type_id = 101 then 1 end) as theme_type_101,
	count(case when lti.loan_theme_type_id = 102 then 1 end) as theme_type_102,
	count(case when lti.loan_theme_type_id = 103 then 1 end) as theme_type_103,
	count(case when lti.loan_theme_type_id = 104 then 1 end) as theme_type_104,
	count(case when lti.loan_theme_type_id = 105 then 1 end) as theme_type_105,
	count(case when lti.loan_theme_type_id = 106 then 1 end) as theme_type_106,
	count(case when lti.loan_theme_type_id = 107 then 1 end) as theme_type_107,
	count(case when lti.loan_theme_type_id = 108 then 1 end) as theme_type_108,
	count(case when lti.loan_theme_type_id = 109 then 1 end) as theme_type_109,
	count(case when lti.loan_theme_type_id = 110 then 1 end) as theme_type_110,
	count(case when lti.loan_theme_type_id = 111 then 1 end) as theme_type_111,
	count(case when lti.loan_theme_type_id = 112 then 1 end) as theme_type_112,
	count(case when lti.loan_theme_type_id = 113 then 1 end) as theme_type_113,
	count(case when lti.loan_theme_type_id = 114 then 1 end) as theme_type_114,
	count(case when lti.loan_theme_type_id = 115 then 1 end) as theme_type_115,
	count(case when lti.loan_theme_type_id = 116 then 1 end) as theme_type_116,
	count(case when lti.loan_theme_type_id = 117 then 1 end) as theme_type_117,
	count(case when lti.loan_theme_type_id = 118 then 1 end) as theme_type_118,
	count(case when lti.loan_theme_type_id = 119 then 1 end) as theme_type_119,
	count(case when lti.loan_theme_type_id = 120 then 1 end) as theme_type_120,
	count(case when lti.loan_theme_type_id = 121 then 1 end) as theme_type_121,
	count(case when lti.loan_theme_type_id = 122 then 1 end) as theme_type_122,
	count(case when lti.loan_theme_type_id = 123 then 1 end) as theme_type_123,
	count(case when lti.loan_theme_type_id = 124 then 1 end) as theme_type_124,
	count(case when lti.loan_theme_type_id = 125 then 1 end) as theme_type_125,
	count(case when lti.loan_theme_type_id = 126 then 1 end) as theme_type_126,
	count(case when lti.loan_theme_type_id = 127 then 1 end) as theme_type_127,
	count(case when lti.loan_theme_type_id = 128 then 1 end) as theme_type_128,
	count(case when lti.loan_theme_type_id = 129 then 1 end) as theme_type_129,
	count(case when lti.loan_theme_type_id = 130 then 1 end) as theme_type_130,
	count(case when lti.loan_theme_type_id = 131 then 1 end) as theme_type_131,
	count(case when lti.loan_theme_type_id = 132 then 1 end) as theme_type_132,
	count(case when lti.loan_theme_type_id = 133 then 1 end) as theme_type_133,
	count(case when lti.loan_theme_type_id = 134 then 1 end) as theme_type_134,
	count(case when lti.loan_theme_type_id = 135 then 1 end) as theme_type_135,
	count(case when lti.loan_theme_type_id = 136 then 1 end) as theme_type_136,
	count(case when lti.loan_theme_type_id = 137 then 1 end) as theme_type_137,
	count(case when lti.loan_theme_type_id = 138 then 1 end) as theme_type_138,
	count(case when lti.loan_theme_type_id = 139 then 1 end) as theme_type_139,
	count(case when lti.loan_theme_type_id = 140 then 1 end) as theme_type_140,
	count(case when lti.loan_theme_type_id = 141 then 1 end) as theme_type_141,
	count(case when lti.loan_theme_type_id = 142 then 1 end) as theme_type_142,
	count(case when lti.loan_theme_type_id = 143 then 1 end) as theme_type_143,
	count(case when lti.loan_theme_type_id = 144 then 1 end) as theme_type_144,
	count(case when lti.loan_theme_type_id = 145 then 1 end) as theme_type_145,
	count(case when lti.loan_theme_type_id = 146 then 1 end) as theme_type_146,
	count(case when lti.loan_theme_type_id = 147 then 1 end) as theme_type_147,
	count(case when lti.loan_theme_type_id = 148 then 1 end) as theme_type_148,
	count(case when lti.loan_theme_type_id = 149 then 1 end) as theme_type_149,
	count(case when lti.loan_theme_type_id = 150 then 1 end) as theme_type_150,
	count(case when lti.loan_theme_type_id = 151 then 1 end) as theme_type_151,
	count(case when lti.loan_theme_type_id = 152 then 1 end) as theme_type_152,
	count(case when lti.loan_theme_type_id = 153 then 1 end) as theme_type_153,
	count(case when lti.loan_theme_type_id = 154 then 1 end) as theme_type_154,
	count(case when lti.loan_theme_type_id = 155 then 1 end) as theme_type_155,
	count(case when lti.loan_theme_type_id = 156 then 1 end) as theme_type_156,
	count(case when lti.loan_theme_type_id = 157 then 1 end) as theme_type_157,
	count(case when lti.loan_theme_type_id = 158 then 1 end) as theme_type_158,
	count(case when lti.loan_theme_type_id = 159 then 1 end) as theme_type_159,
	count(case when lti.loan_theme_type_id = 160 then 1 end) as theme_type_160,
	count(case when lti.loan_theme_type_id = 161 then 1 end) as theme_type_161,
	count(case when lti.loan_theme_type_id = 162 then 1 end) as theme_type_162,
	count(case when lti.loan_theme_type_id = 163 then 1 end) as theme_type_163,
	count(case when lti.loan_theme_type_id = 164 then 1 end) as theme_type_164,
	count(case when lti.loan_theme_type_id = 165 then 1 end) as theme_type_165,
	count(case when lti.loan_theme_type_id = 166 then 1 end) as theme_type_166,
	count(case when lti.loan_theme_type_id = 167 then 1 end) as theme_type_167,
	count(case when lti.loan_theme_type_id = 168 then 1 end) as theme_type_168,
	count(case when lti.loan_theme_type_id = 169 then 1 end) as theme_type_169,
	count(case when lti.loan_theme_type_id = 170 then 1 end) as theme_type_170,
	count(case when lti.loan_theme_type_id = 171 then 1 end) as theme_type_171,
	count(case when lti.loan_theme_type_id = 172 then 1 end) as theme_type_172,
	count(case when lti.loan_theme_type_id = 173 then 1 end) as theme_type_173,
	count(case when lti.loan_theme_type_id = 174 then 1 end) as theme_type_174,
	count(case when lti.loan_theme_type_id = 175 then 1 end) as theme_type_175,
	count(case when lti.loan_theme_type_id = 176 then 1 end) as theme_type_176,
	count(case when lti.loan_theme_type_id = 177 then 1 end) as theme_type_177,
	count(case when lti.loan_theme_type_id = 178 then 1 end) as theme_type_178,
	count(case when lti.loan_theme_type_id = 179 then 1 end) as theme_type_179,
	count(case when lti.loan_theme_type_id = 180 then 1 end) as theme_type_180,
	count(case when lti.loan_theme_type_id = 181 then 1 end) as theme_type_181,
	count(case when lti.loan_theme_type_id = 182 then 1 end) as theme_type_182,
	count(case when lti.loan_theme_type_id = 183 then 1 end) as theme_type_183,
	count(case when lti.loan_theme_type_id = 184 then 1 end) as theme_type_184,
	count(case when lti.loan_theme_type_id = 185 then 1 end) as theme_type_185,
	count(case when lti.loan_theme_type_id = 186 then 1 end) as theme_type_186,
	count(case when lti.loan_theme_type_id = 187 then 1 end) as theme_type_187,
	count(case when lti.loan_theme_type_id = 188 then 1 end) as theme_type_188,
	count(case when lti.loan_theme_type_id = 189 then 1 end) as theme_type_189,
	count(case when lti.loan_theme_type_id = 190 then 1 end) as theme_type_190,
	count(case when lti.loan_theme_type_id = 191 then 1 end) as theme_type_191,
	count(case when lti.loan_theme_type_id = 192 then 1 end) as theme_type_192,
	count(case when lti.loan_theme_type_id = 193 then 1 end) as theme_type_193,
	count(case when lti.loan_theme_type_id = 194 then 1 end) as theme_type_194,
	count(case when lti.loan_theme_type_id = 195 then 1 end) as theme_type_195,
	count(case when lti.loan_theme_type_id = 196 then 1 end) as theme_type_196,
	count(case when lti.loan_theme_type_id = 197 then 1 end) as theme_type_197,
	count(case when lti.loan_theme_type_id = 198 then 1 end) as theme_type_198,
	count(case when lti.loan_theme_type_id = 199 then 1 end) as theme_type_199,
	count(case when lti.loan_theme_type_id = 200 then 1 end) as theme_type_200,
	count(case when lti.loan_theme_type_id = 201 then 1 end) as theme_type_201,
	count(case when lti.loan_theme_type_id = 202 then 1 end) as theme_type_202,
	count(case when lti.loan_theme_type_id = 203 then 1 end) as theme_type_203,
	count(case when lti.loan_theme_type_id = 204 then 1 end) as theme_type_204,
	count(case when lti.loan_theme_type_id = 205 then 1 end) as theme_type_205,
	count(case when lti.loan_theme_type_id = 206 then 1 end) as theme_type_206,
	count(case when lti.loan_theme_type_id = 207 then 1 end) as theme_type_207,
	count(case when lti.loan_theme_type_id = 208 then 1 end) as theme_type_208,
	count(case when lti.loan_theme_type_id = 209 then 1 end) as theme_type_209,
	count(case when lti.loan_theme_type_id = 210 then 1 end) as theme_type_210,
	count(case when lti.loan_theme_type_id = 211 then 1 end) as theme_type_211,
	count(case when lti.loan_theme_type_id = 212 then 1 end) as theme_type_212,
	count(case when lti.loan_theme_type_id = 213 then 1 end) as theme_type_213,
	count(case when lti.loan_theme_type_id = 214 then 1 end) as theme_type_214,
	count(case when lti.loan_theme_type_id = 215 then 1 end) as theme_type_215,
	count(case when lti.loan_theme_type_id = 216 then 1 end) as theme_type_216,
	count(case when lti.loan_theme_type_id = 217 then 1 end) as theme_type_217,
	count(case when lti.loan_theme_type_id = 218 then 1 end) as theme_type_218,
	count(case when lti.loan_theme_type_id = 219 then 1 end) as theme_type_219,
	count(case when lti.loan_theme_type_id = 220 then 1 end) as theme_type_220,
	count(case when lti.loan_theme_type_id = 221 then 1 end) as theme_type_221,
	count(case when lti.loan_theme_type_id = 222 then 1 end) as theme_type_222,
	count(case when lti.loan_theme_type_id = 223 then 1 end) as theme_type_223,
	count(case when lti.loan_theme_type_id = 224 then 1 end) as theme_type_224,
	count(case when lti.loan_theme_type_id = 225 then 1 end) as theme_type_225,
	count(case when lti.loan_theme_type_id = 226 then 1 end) as theme_type_226,
	count(case when lti.loan_theme_type_id = 227 then 1 end) as theme_type_227,
	count(case when lti.loan_theme_type_id = 228 then 1 end) as theme_type_228,
	count(case when lti.loan_theme_type_id = 229 then 1 end) as theme_type_229,
	count(case when lti.loan_theme_type_id = 230 then 1 end) as theme_type_230,
	count(case when lti.loan_theme_type_id = 231 then 1 end) as theme_type_231,
	count(case when lti.loan_theme_type_id = 232 then 1 end) as theme_type_232,
	count(case when lti.loan_theme_type_id = 233 then 1 end) as theme_type_233,
	count(case when lti.loan_theme_type_id = 234 then 1 end) as theme_type_234,
	count(case when lti.loan_theme_type_id = 235 then 1 end) as theme_type_235,
	count(case when lti.loan_theme_type_id = 236 then 1 end) as theme_type_236,
	count(case when lti.loan_theme_type_id = 237 then 1 end) as theme_type_237,
	count(case when lti.loan_theme_type_id = 238 then 1 end) as theme_type_238,
	count(case when lti.loan_theme_type_id = 239 then 1 end) as theme_type_239,
	count(case when lti.loan_theme_type_id = 240 then 1 end) as theme_type_240,
	count(case when lti.loan_theme_type_id = 241 then 1 end) as theme_type_241,
	count(case when lti.loan_theme_type_id = 242 then 1 end) as theme_type_242,
	count(case when lti.loan_theme_type_id = 243 then 1 end) as theme_type_243,
	count(case when lti.loan_theme_type_id = 244 then 1 end) as theme_type_244,
	count(case when lti.loan_theme_type_id = 245 then 1 end) as theme_type_245,
	count(case when lti.loan_theme_type_id = 246 then 1 end) as theme_type_246,
	count(case when lti.loan_theme_type_id = 247 then 1 end) as theme_type_247,
	count(case when lti.loan_theme_type_id = 248 then 1 end) as theme_type_248,
	count(case when lti.loan_theme_type_id = 249 then 1 end) as theme_type_249,
	count(case when lti.loan_theme_type_id = 250 then 1 end) as theme_type_250,
	count(case when lti.loan_theme_type_id = 251 then 1 end) as theme_type_251,
	count(case when lti.loan_theme_type_id = 252 then 1 end) as theme_type_252,
	count(case when lti.loan_theme_type_id = 253 then 1 end) as theme_type_253,
	count(case when lti.loan_theme_type_id = 254 then 1 end) as theme_type_254,
	count(case when lti.loan_theme_type_id = 255 then 1 end) as theme_type_255,
	count(case when lti.loan_theme_type_id = 256 then 1 end) as theme_type_256,
	count(case when lti.loan_theme_type_id = 257 then 1 end) as theme_type_257,
	count(case when lti.loan_theme_type_id = 258 then 1 end) as theme_type_258,
	count(case when lti.loan_theme_type_id = 259 then 1 end) as theme_type_259,
	count(case when lti.loan_theme_type_id = 260 then 1 end) as theme_type_260,
	count(case when lti.loan_theme_type_id = 261 then 1 end) as theme_type_261,
	count(case when lti.loan_theme_type_id = 262 then 1 end) as theme_type_262,
	count(case when lti.loan_theme_type_id = 263 then 1 end) as theme_type_263,
	count(case when lti.loan_theme_type_id = 264 then 1 end) as theme_type_264,
	count(case when lti.loan_theme_type_id = 265 then 1 end) as theme_type_265,
	count(case when lti.loan_theme_type_id = 266 then 1 end) as theme_type_266,
	count(case when lti.loan_theme_type_id = 267 then 1 end) as theme_type_267,
	count(case when lti.loan_theme_type_id = 268 then 1 end) as theme_type_268,
	count(case when lti.loan_theme_type_id = 269 then 1 end) as theme_type_269,
	count(case when lti.loan_theme_type_id = 270 then 1 end) as theme_type_270,
	count(case when lti.loan_theme_type_id = 271 then 1 end) as theme_type_271,
	count(case when lti.loan_theme_type_id = 272 then 1 end) as theme_type_272,
	count(case when lti.loan_theme_type_id = 273 then 1 end) as theme_type_273,
	count(case when lti.loan_theme_type_id = 274 then 1 end) as theme_type_274,
	count(case when lti.loan_theme_type_id = 275 then 1 end) as theme_type_275,
	count(case when lti.loan_theme_type_id = 276 then 1 end) as theme_type_276,
	count(case when lti.loan_theme_type_id = 277 then 1 end) as theme_type_277,
	count(case when lti.loan_theme_type_id = 278 then 1 end) as theme_type_278,
	count(case when lti.loan_theme_type_id = 279 then 1 end) as theme_type_279,
	count(case when lti.loan_theme_type_id = 280 then 1 end) as theme_type_280,
	count(case when lti.loan_theme_type_id = 281 then 1 end) as theme_type_281,
	count(case when lti.loan_theme_type_id = 282 then 1 end) as theme_type_282,
	count(case when lti.loan_theme_type_id = 283 then 1 end) as theme_type_283,
	count(case when lti.loan_theme_type_id = 284 then 1 end) as theme_type_284,
	count(case when lti.loan_theme_type_id = 285 then 1 end) as theme_type_285,
	count(case when lti.loan_theme_type_id = 286 then 1 end) as theme_type_286,
	count(case when lti.loan_theme_type_id = 287 then 1 end) as theme_type_287,
	count(case when lti.loan_theme_type_id = 288 then 1 end) as theme_type_288,
	count(case when lti.loan_theme_type_id = 289 then 1 end) as theme_type_289,
	count(case when lti.loan_theme_type_id = 290 then 1 end) as theme_type_290,
	count(case when lti.loan_theme_type_id = 291 then 1 end) as theme_type_291,
	count(case when lti.loan_theme_type_id = 292 then 1 end) as theme_type_292,
	count(case when lti.loan_theme_type_id = 293 then 1 end) as theme_type_293,
	count(case when lti.loan_theme_type_id = 294 then 1 end) as theme_type_294,
	count(case when lti.loan_theme_type_id = 295 then 1 end) as theme_type_295,
	count(case when lti.loan_theme_type_id = 296 then 1 end) as theme_type_296,
	count(case when lti.loan_theme_type_id = 297 then 1 end) as theme_type_297,
	count(case when lti.loan_theme_type_id = 298 then 1 end) as theme_type_298,
	count(case when lti.loan_theme_type_id = 299 then 1 end) as theme_type_299,
	count(case when lti.loan_theme_type_id = 300 then 1 end) as theme_type_300,
	count(case when ltag.user_tag_list like '%00005%' then 1 end) as tag_5,
	count(case when ltag.user_tag_list like '%00006%' then 1 end) as tag_6,
	count(case when ltag.user_tag_list like '%00007%' then 1 end) as tag_7,
	count(case when ltag.user_tag_list like '%00008%' then 1 end) as tag_8,
	count(case when ltag.user_tag_list like '%00009%' then 1 end) as tag_9,
	count(case when ltag.user_tag_list like '%00010%' then 1 end) as tag_10,
	count(case when ltag.user_tag_list like '%00011%' then 1 end) as tag_11,
	count(case when ltag.user_tag_list like '%00012%' then 1 end) as tag_12,
	count(case when ltag.user_tag_list like '%00013%' then 1 end) as tag_13,
	count(case when ltag.user_tag_list like '%00014%' then 1 end) as tag_14,
	count(case when ltag.user_tag_list like '%00015%' then 1 end) as tag_15,
	count(case when ltag.user_tag_list like '%00016%' then 1 end) as tag_16,
	count(case when ltag.user_tag_list like '%00017%' then 1 end) as tag_17,
	count(case when ltag.user_tag_list like '%00018%' then 1 end) as tag_18,
	count(case when ltag.user_tag_list like '%00019%' then 1 end) as tag_19,
	count(case when ltag.user_tag_list like '%00020%' then 1 end) as tag_20,
	count(case when ltag.user_tag_list like '%00021%' then 1 end) as tag_21,
	count(case when ltag.user_tag_list like '%00022%' then 1 end) as tag_22,
	count(case when ltag.user_tag_list like '%00023%' then 1 end) as tag_23,
	count(case when ltag.user_tag_list like '%00024%' then 1 end) as tag_24,
	count(case when ltag.user_tag_list like '%00025%' then 1 end) as tag_25,
	count(case when ltag.user_tag_list like '%00026%' then 1 end) as tag_26,
	count(case when ltag.user_tag_list like '%00027%' then 1 end) as tag_27,
	count(case when ltag.user_tag_list like '%00028%' then 1 end) as tag_28,
	count(case when ltag.user_tag_list like '%00029%' then 1 end) as tag_29,
	count(case when ltag.user_tag_list like '%00030%' then 1 end) as tag_30,
	count(case when ltag.user_tag_list like '%00031%' then 1 end) as tag_31,
	count(case when ltag.user_tag_list like '%00032%' then 1 end) as tag_32,
	count(case when ltag.user_tag_list like '%00033%' then 1 end) as tag_33,
	count(case when ltag.user_tag_list like '%00034%' then 1 end) as tag_34,
	count(case when ltag.user_tag_list like '%00035%' then 1 end) as tag_35,
	count(case when ltag.user_tag_list like '%00036%' then 1 end) as tag_36,
	count(case when ltag.user_tag_list like '%00037%' then 1 end) as tag_37,
	count(case when ltag.user_tag_list like '%00038%' then 1 end) as tag_38,
	count(case when ltag.user_tag_list like '%00039%' then 1 end) as tag_39,
	count(case when ltag.user_tag_list like '%00040%' then 1 end) as tag_40,
	count(case when ltag.user_tag_list like '%00041%' then 1 end) as tag_41,
	count(case when ltag.user_tag_list like '%00042%' then 1 end) as tag_42,
	count(case when ltag.user_tag_list like '%00043%' then 1 end) as tag_43,
	count(case when ltag.user_tag_list like '%00044%' then 1 end) as tag_44,
	count(case when ltag.user_tag_list like '%00045%' then 1 end) as tag_45,
	count(case when ltag.user_tag_list like '%00046%' then 1 end) as tag_46,
	count(case when ltag.user_tag_list like '%00047%' then 1 end) as tag_47,
	count(case when ltag.user_tag_list like '%00048%' then 1 end) as tag_48,
	count(case when ltag.user_tag_list like '%00049%' then 1 end) as tag_49,
	count(case when ltag.user_tag_list like '%00050%' then 1 end) as tag_50,
	count(case when ltag.user_tag_list like '%00051%' then 1 end) as tag_51,
	count(case when ltag.user_tag_list like '%00052%' then 1 end) as tag_52,
	count(case when ltag.user_tag_list like '%00053%' then 1 end) as tag_53,
	count(case when ltag.user_tag_list like '%00054%' then 1 end) as tag_54,
	count(case when ltag.user_tag_list like '%00055%' then 1 end) as tag_55,
	count(case when ltag.user_tag_list like '%00056%' then 1 end) as tag_56,
	count(case when ltag.user_tag_list like '%00057%' then 1 end) as tag_57,
	count(case when ltag.user_tag_list like '%00058%' then 1 end) as tag_58,
	count(case when ltag.user_tag_list like '%00059%' then 1 end) as tag_59,
	count(case when ltag.user_tag_list like '%00060%' then 1 end) as tag_60,
	count(case when ltag.user_tag_list like '%00061%' then 1 end) as tag_61,
	count(case when ltag.user_tag_list like '%00062%' then 1 end) as tag_62,
	count(case when ltag.user_tag_list like '%00063%' then 1 end) as tag_63,
	count(case when ltag.user_tag_list like '%00064%' then 1 end) as tag_64,
	count(case when ltag.user_tag_list like '%00065%' then 1 end) as tag_65,
	count(case when ltag.user_tag_list like '%00066%' then 1 end) as tag_66,
	count(case when ltag.user_tag_list like '%00067%' then 1 end) as tag_67,
	count(case when ltag.user_tag_list like '%00068%' then 1 end) as tag_68,
	count(case when ltag.user_tag_list like '%00069%' then 1 end) as tag_69,
	count(case when ltag.user_tag_list like '%00070%' then 1 end) as tag_70,
	count(case when ltag.user_tag_list like '%00071%' then 1 end) as tag_71,
	count(case when ltag.user_tag_list like '%00072%' then 1 end) as tag_72,
	count(case when ltag.user_tag_list like '%00073%' then 1 end) as tag_73,
	count(case when ltag.user_tag_list like '%00074%' then 1 end) as tag_74,
	count(case when ltag.user_tag_list like '%00075%' then 1 end) as tag_75,
	count(case when ltag.user_tag_list like '%00076%' then 1 end) as tag_76,
	count(case when ltag.user_tag_list like '%00077%' then 1 end) as tag_77,
	count(case when ltag.user_tag_list like '%00078%' then 1 end) as tag_78,
	count(case when ltag.user_tag_list like '%00079%' then 1 end) as tag_79,
	count(case when ltag.user_tag_list like '%00080%' then 1 end) as tag_80,
	count(case when ltag.user_tag_list like '%00081%' then 1 end) as tag_81,
	count(case when ltag.user_tag_list like '%00082%' then 1 end) as tag_82,
	count(case when ltag.user_tag_list like '%00083%' then 1 end) as tag_83,
	count(case when ltag.user_tag_list like '%00084%' then 1 end) as tag_84,
	count(case when ltag.user_tag_list like '%00085%' then 1 end) as tag_85,
	count(case when ltag.user_tag_list like '%00086%' then 1 end) as tag_86,
	count(case when ltag.user_tag_list like '%00087%' then 1 end) as tag_87,
	count(case when ltag.user_tag_list like '%00088%' then 1 end) as tag_88,
	count(case when ltag.user_tag_list like '%00089%' then 1 end) as tag_89,
	count(case when ltag.user_tag_list like '%00090%' then 1 end) as tag_90,
	count(case when ltag.user_tag_list like '%00091%' then 1 end) as tag_91,
	count(case when ltag.user_tag_list like '%00092%' then 1 end) as tag_92,
	count(case when ltag.user_tag_list like '%00093%' then 1 end) as tag_93,
	count(case when ltag.user_tag_list like '%00094%' then 1 end) as tag_94,
	count(case when ltag.user_tag_list like '%00095%' then 1 end) as tag_95,
	count(case when ltag.user_tag_list like '%00096%' then 1 end) as tag_96,
	count(case when ltag.user_tag_list like '%00097%' then 1 end) as tag_97,
	count(case when ltag.user_tag_list like '%00098%' then 1 end) as tag_98,
	count(case when ltag.user_tag_list like '%00099%' then 1 end) as tag_99,
	count(case when ltag.user_tag_list like '%00100%' then 1 end) as tag_100,
	count(case when ltag.user_tag_list like '%00101%' then 1 end) as tag_101,
	count(case when ltag.user_tag_list like '%00102%' then 1 end) as tag_102,
	count(case when ltag.user_tag_list like '%00103%' then 1 end) as tag_103,
	count(case when ltag.user_tag_list like '%00104%' then 1 end) as tag_104,
	count(case when ltag.user_tag_list like '%00105%' then 1 end) as tag_105,
	count(case when ltag.user_tag_list like '%00106%' then 1 end) as tag_106,
	count(case when ltag.user_tag_list like '%00107%' then 1 end) as tag_107,
	count(case when ltag.user_tag_list like '%00108%' then 1 end) as tag_108,
	count(case when ltag.user_tag_list like '%00109%' then 1 end) as tag_109,
	count(case when ltag.user_tag_list like '%00110%' then 1 end) as tag_110,
	count(case when ltag.user_tag_list like '%00111%' then 1 end) as tag_111,
	count(case when ltag.user_tag_list like '%00112%' then 1 end) as tag_112,
	count(case when ltag.user_tag_list like '%00113%' then 1 end) as tag_113,
	count(case when ltag.user_tag_list like '%00114%' then 1 end) as tag_114,
	count(case when ltag.user_tag_list like '%00115%' then 1 end) as tag_115,
	count(case when ltag.user_tag_list like '%00116%' then 1 end) as tag_116,
	count(case when ltag.user_tag_list like '%00117%' then 1 end) as tag_117,
	count(case when ltag.user_tag_list like '%00118%' then 1 end) as tag_118,
	count(case when ltag.user_tag_list like '%00119%' then 1 end) as tag_119,
	count(case when ltag.user_tag_list like '%00120%' then 1 end) as tag_120,
	count(case when ltag.user_tag_list like '%00121%' then 1 end) as tag_121,
	count(case when ltag.user_tag_list like '%00122%' then 1 end) as tag_122,
	count(case when ltag.user_tag_list like '%00123%' then 1 end) as tag_123,
	count(case when ltag.user_tag_list like '%00124%' then 1 end) as tag_124,
	count(case when ltag.user_tag_list like '%00125%' then 1 end) as tag_125,
	count(case when ltag.user_tag_list like '%00126%' then 1 end) as tag_126,
	count(case when ltag.user_tag_list like '%00127%' then 1 end) as tag_127,
	count(case when ltag.user_tag_list like '%00128%' then 1 end) as tag_128,
	count(case when ltag.user_tag_list like '%00129%' then 1 end) as tag_129,
	count(case when ltag.user_tag_list like '%00130%' then 1 end) as tag_130,
	count(case when ltag.user_tag_list like '%00131%' then 1 end) as tag_131,
	count(case when ltag.user_tag_list like '%00132%' then 1 end) as tag_132,
	count(case when ltag.user_tag_list like '%00133%' then 1 end) as tag_133,
	count(case when c.id = 1 then 1 end) as country_1,
	count(case when c.id = 2 then 1 end) as country_2,
	count(case when c.id = 3 then 1 end) as country_3,
	count(case when c.id = 4 then 1 end) as country_4,
	count(case when c.id = 5 then 1 end) as country_5,
	count(case when c.id = 6 then 1 end) as country_6,
	count(case when c.id = 7 then 1 end) as country_7,
	count(case when c.id = 8 then 1 end) as country_8,
	count(case when c.id = 9 then 1 end) as country_9,
	count(case when c.id = 10 then 1 end) as country_10,
	count(case when c.id = 11 then 1 end) as country_11,
	count(case when c.id = 12 then 1 end) as country_12,
	count(case when c.id = 13 then 1 end) as country_13,
	count(case when c.id = 14 then 1 end) as country_14,
	count(case when c.id = 15 then 1 end) as country_15,
	count(case when c.id = 16 then 1 end) as country_16,
	count(case when c.id = 17 then 1 end) as country_17,
	count(case when c.id = 18 then 1 end) as country_18,
	count(case when c.id = 19 then 1 end) as country_19,
	count(case when c.id = 20 then 1 end) as country_20,
	count(case when c.id = 21 then 1 end) as country_21,
	count(case when c.id = 22 then 1 end) as country_22,
	count(case when c.id = 23 then 1 end) as country_23,
	count(case when c.id = 24 then 1 end) as country_24,
	count(case when c.id = 25 then 1 end) as country_25,
	count(case when c.id = 26 then 1 end) as country_26,
	count(case when c.id = 27 then 1 end) as country_27,
	count(case when c.id = 28 then 1 end) as country_28,
	count(case when c.id = 29 then 1 end) as country_29,
	count(case when c.id = 30 then 1 end) as country_30,
	count(case when c.id = 31 then 1 end) as country_31,
	count(case when c.id = 32 then 1 end) as country_32,
	count(case when c.id = 33 then 1 end) as country_33,
	count(case when c.id = 34 then 1 end) as country_34,
	count(case when c.id = 35 then 1 end) as country_35,
	count(case when c.id = 36 then 1 end) as country_36,
	count(case when c.id = 37 then 1 end) as country_37,
	count(case when c.id = 38 then 1 end) as country_38,
	count(case when c.id = 39 then 1 end) as country_39,
	count(case when c.id = 40 then 1 end) as country_40,
	count(case when c.id = 41 then 1 end) as country_41,
	count(case when c.id = 42 then 1 end) as country_42,
	count(case when c.id = 43 then 1 end) as country_43,
	count(case when c.id = 44 then 1 end) as country_44,
	count(case when c.id = 45 then 1 end) as country_45,
	count(case when c.id = 46 then 1 end) as country_46,
	count(case when c.id = 47 then 1 end) as country_47,
	count(case when c.id = 48 then 1 end) as country_48,
	count(case when c.id = 49 then 1 end) as country_49,
	count(case when c.id = 50 then 1 end) as country_50,
	count(case when c.id = 51 then 1 end) as country_51,
	count(case when c.id = 52 then 1 end) as country_52,
	count(case when c.id = 53 then 1 end) as country_53,
	count(case when c.id = 54 then 1 end) as country_54,
	count(case when c.id = 55 then 1 end) as country_55,
	count(case when c.id = 56 then 1 end) as country_56,
	count(case when c.id = 57 then 1 end) as country_57,
	count(case when c.id = 58 then 1 end) as country_58,
	count(case when c.id = 59 then 1 end) as country_59,
	count(case when c.id = 60 then 1 end) as country_60,
	count(case when c.id = 61 then 1 end) as country_61,
	count(case when c.id = 62 then 1 end) as country_62,
	count(case when c.id = 63 then 1 end) as country_63,
	count(case when c.id = 64 then 1 end) as country_64,
	count(case when c.id = 65 then 1 end) as country_65,
	count(case when c.id = 66 then 1 end) as country_66,
	count(case when c.id = 67 then 1 end) as country_67,
	count(case when c.id = 68 then 1 end) as country_68,
	count(case when c.id = 69 then 1 end) as country_69,
	count(case when c.id = 70 then 1 end) as country_70,
	count(case when c.id = 71 then 1 end) as country_71,
	count(case when c.id = 72 then 1 end) as country_72,
	count(case when c.id = 73 then 1 end) as country_73,
	count(case when c.id = 74 then 1 end) as country_74,
	count(case when c.id = 75 then 1 end) as country_75,
	count(case when c.id = 76 then 1 end) as country_76,
	count(case when c.id = 77 then 1 end) as country_77,
	count(case when c.id = 78 then 1 end) as country_78,
	count(case when c.id = 79 then 1 end) as country_79,
	count(case when c.id = 80 then 1 end) as country_80,
	count(case when c.id = 81 then 1 end) as country_81,
	count(case when c.id = 82 then 1 end) as country_82,
	count(case when c.id = 83 then 1 end) as country_83,
	count(case when c.id = 84 then 1 end) as country_84,
	count(case when c.id = 85 then 1 end) as country_85,
	count(case when c.id = 86 then 1 end) as country_86,
	count(case when c.id = 87 then 1 end) as country_87,
	count(case when c.id = 88 then 1 end) as country_88,
	count(case when c.id = 89 then 1 end) as country_89,
	count(case when c.id = 90 then 1 end) as country_90,
	count(case when c.id = 91 then 1 end) as country_91,
	count(case when c.id = 92 then 1 end) as country_92,
	count(case when c.id = 93 then 1 end) as country_93,
	count(case when c.id = 94 then 1 end) as country_94,
	count(case when c.id = 95 then 1 end) as country_95,
	count(case when c.id = 96 then 1 end) as country_96,
	count(case when c.id = 97 then 1 end) as country_97,
	count(case when c.id = 98 then 1 end) as country_98,
	count(case when c.id = 99 then 1 end) as country_99,
	count(case when c.id = 100 then 1 end) as country_100,
	count(case when c.id = 101 then 1 end) as country_101,
	count(case when c.id = 102 then 1 end) as country_102,
	count(case when c.id = 103 then 1 end) as country_103,
	count(case when c.id = 104 then 1 end) as country_104,
	count(case when c.id = 105 then 1 end) as country_105,
	count(case when c.id = 106 then 1 end) as country_106,
	count(case when c.id = 107 then 1 end) as country_107,
	count(case when c.id = 108 then 1 end) as country_108,
	count(case when c.id = 109 then 1 end) as country_109,
	count(case when c.id = 110 then 1 end) as country_110,
	count(case when c.id = 111 then 1 end) as country_111,
	count(case when c.id = 112 then 1 end) as country_112,
	count(case when c.id = 113 then 1 end) as country_113,
	count(case when c.id = 114 then 1 end) as country_114,
	count(case when c.id = 115 then 1 end) as country_115,
	count(case when c.id = 116 then 1 end) as country_116,
	count(case when c.id = 117 then 1 end) as country_117,
	count(case when c.id = 118 then 1 end) as country_118,
	count(case when c.id = 119 then 1 end) as country_119,
	count(case when c.id = 120 then 1 end) as country_120,
	count(case when c.id = 121 then 1 end) as country_121,
	count(case when c.id = 122 then 1 end) as country_122,
	count(case when c.id = 123 then 1 end) as country_123,
	count(case when c.id = 124 then 1 end) as country_124,
	count(case when c.id = 125 then 1 end) as country_125,
	count(case when c.id = 126 then 1 end) as country_126,
	count(case when c.id = 127 then 1 end) as country_127,
	count(case when c.id = 128 then 1 end) as country_128,
	count(case when c.id = 129 then 1 end) as country_129,
	count(case when c.id = 130 then 1 end) as country_130,
	count(case when c.id = 131 then 1 end) as country_131,
	count(case when c.id = 132 then 1 end) as country_132,
	count(case when c.id = 133 then 1 end) as country_133,
	count(case when c.id = 134 then 1 end) as country_134,
	count(case when c.id = 135 then 1 end) as country_135,
	count(case when c.id = 136 then 1 end) as country_136,
	count(case when c.id = 137 then 1 end) as country_137,
	count(case when c.id = 138 then 1 end) as country_138,
	count(case when c.id = 139 then 1 end) as country_139,
	count(case when c.id = 140 then 1 end) as country_140,
	count(case when c.id = 141 then 1 end) as country_141,
	count(case when c.id = 142 then 1 end) as country_142,
	count(case when c.id = 143 then 1 end) as country_143,
	count(case when c.id = 144 then 1 end) as country_144,
	count(case when c.id = 145 then 1 end) as country_145,
	count(case when c.id = 146 then 1 end) as country_146,
	count(case when c.id = 147 then 1 end) as country_147,
	count(case when c.id = 148 then 1 end) as country_148,
	count(case when c.id = 149 then 1 end) as country_149,
	count(case when c.id = 150 then 1 end) as country_150,
	count(case when c.id = 151 then 1 end) as country_151,
	count(case when c.id = 152 then 1 end) as country_152,
	count(case when c.id = 153 then 1 end) as country_153,
	count(case when c.id = 154 then 1 end) as country_154,
	count(case when c.id = 155 then 1 end) as country_155,
	count(case when c.id = 156 then 1 end) as country_156,
	count(case when c.id = 157 then 1 end) as country_157,
	count(case when c.id = 158 then 1 end) as country_158,
	count(case when c.id = 159 then 1 end) as country_159,
	count(case when c.id = 160 then 1 end) as country_160,
	count(case when c.id = 161 then 1 end) as country_161,
	count(case when c.id = 162 then 1 end) as country_162,
	count(case when c.id = 163 then 1 end) as country_163,
	count(case when c.id = 164 then 1 end) as country_164,
	count(case when c.id = 165 then 1 end) as country_165,
	count(case when c.id = 166 then 1 end) as country_166,
	count(case when c.id = 167 then 1 end) as country_167,
	count(case when c.id = 168 then 1 end) as country_168,
	count(case when c.id = 169 then 1 end) as country_169,
	count(case when c.id = 170 then 1 end) as country_170,
	count(case when c.id = 171 then 1 end) as country_171,
	count(case when c.id = 172 then 1 end) as country_172,
	count(case when c.id = 173 then 1 end) as country_173,
	count(case when c.id = 174 then 1 end) as country_174,
	count(case when c.id = 175 then 1 end) as country_175,
	count(case when c.id = 176 then 1 end) as country_176,
	count(case when c.id = 177 then 1 end) as country_177,
	count(case when c.id = 178 then 1 end) as country_178,
	count(case when c.id = 179 then 1 end) as country_179,
	count(case when c.id = 180 then 1 end) as country_180,
	count(case when c.id = 181 then 1 end) as country_181,
	count(case when c.id = 182 then 1 end) as country_182,
	count(case when c.id = 183 then 1 end) as country_183,
	count(case when c.id = 184 then 1 end) as country_184,
	count(case when c.id = 185 then 1 end) as country_185,
	count(case when c.id = 186 then 1 end) as country_186,
	count(case when c.id = 187 then 1 end) as country_187,
	count(case when c.id = 188 then 1 end) as country_188,
	count(case when c.id = 189 then 1 end) as country_189,
	count(case when c.id = 190 then 1 end) as country_190,
	count(case when c.id = 191 then 1 end) as country_191,
	count(case when c.id = 192 then 1 end) as country_192,
	count(case when c.id = 193 then 1 end) as country_193,
	count(case when c.id = 194 then 1 end) as country_194,
	count(case when c.id = 195 then 1 end) as country_195,
	count(case when c.id = 196 then 1 end) as country_196,
	count(case when c.id = 197 then 1 end) as country_197,
	count(case when c.id = 198 then 1 end) as country_198,
	count(case when c.id = 199 then 1 end) as country_199,
	count(case when c.id = 200 then 1 end) as country_200,
	count(case when c.id = 201 then 1 end) as country_201,
	count(case when c.id = 202 then 1 end) as country_202,
	count(case when c.id = 203 then 1 end) as country_203,
	count(case when c.id = 204 then 1 end) as country_204,
	count(case when c.id = 205 then 1 end) as country_205,
	count(case when c.id = 206 then 1 end) as country_206,
	count(case when c.id = 207 then 1 end) as country_207,
	count(case when c.id = 208 then 1 end) as country_208,
	count(case when c.id = 209 then 1 end) as country_209,
	count(case when c.id = 210 then 1 end) as country_210,
	count(case when c.id = 211 then 1 end) as country_211,
	count(case when c.id = 212 then 1 end) as country_212,
	count(case when c.id = 213 then 1 end) as country_213,
	count(case when c.id = 214 then 1 end) as country_214,
	count(case when c.id = 215 then 1 end) as country_215,
	count(case when c.id = 216 then 1 end) as country_216,
	count(case when c.id = 217 then 1 end) as country_217,
	count(case when c.id = 218 then 1 end) as country_218,
	count(case when c.id = 219 then 1 end) as country_219,
	count(case when c.id = 220 then 1 end) as country_220,
	count(case when c.id = 221 then 1 end) as country_221,
	count(case when c.id = 222 then 1 end) as country_222,
	count(case when c.id = 223 then 1 end) as country_223,
	count(case when c.id = 224 then 1 end) as country_224,
	count(case when c.id = 225 then 1 end) as country_225,
	count(case when c.id = 226 then 1 end) as country_226,
	count(case when c.id = 227 then 1 end) as country_227,
	count(case when c.id = 228 then 1 end) as country_228,
	count(case when c.id = 229 then 1 end) as country_229,
	count(case when c.id = 230 then 1 end) as country_230,
	count(case when c.id = 231 then 1 end) as country_231,
	count(case when c.id = 232 then 1 end) as country_232,
	count(case when c.id = 233 then 1 end) as country_233,
	count(case when c.id = 234 then 1 end) as country_234,
	count(case when c.id = 235 then 1 end) as country_235,
	count(case when c.id = 236 then 1 end) as country_236,
	count(case when c.id = 237 then 1 end) as country_237,
	count(case when c.id = 238 then 1 end) as country_238,
	count(case when c.id = 239 then 1 end) as country_239,
	count(case when c.id = 240 then 1 end) as country_240,
	count(case when c.id = 241 then 1 end) as country_241,
	count(case when c.id = 242 then 1 end) as country_242,
	count(case when c.id = 243 then 1 end) as country_243,
	count(case when c.id = 244 then 1 end) as country_244
from loan l
left join loan_theme_instance lti on l.loan_theme_instance_id = lti.id
left join list_filters ltfa on lti.id = ltfa.loan_theme_instance_id
left join business b on l.business_id = b.id
left join activity a on b.activity_id = a.id
left join activity_mapper am on a.id = am.activity_id
left join sector s on am.sector_id = s.id
left join geocode g on b.geocode_id = g.id
left join country c on g.country_id = c.id
left join list_tags ltag on ltag.loan_id = l.id
where coalesce(l.raised_time, l.expired_time, l.refunded_time, l.deleted_time, l.inactive_expired_time) is null
	and l._fivetran_deleted = false
group by l.id
;
